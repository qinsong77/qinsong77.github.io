

# MonoRepo by pnpm workspace + TurboRepo

[[toc]]

## pnpm

`pnpm` æ˜¯æ–°ä¸€ä»£çš„åŒ…ç®¡ç†å·¥å…·ã€‚æŒ‰ç…§å®˜ç½‘è¯´æ³•ï¼Œå¯ä»¥å®ç°**èŠ‚çº¦ç£ç›˜ç©ºé—´å¹¶æå‡å®‰è£…é€Ÿåº¦å’Œåˆ›å»ºéæ‰å¹³åŒ–çš„ `node_modules` æ–‡ä»¶å¤¹**ä¸¤å¤§ç›®æ ‡ï¼Œå…·ä½“åŸç†å¯ä»¥å‚è€ƒ[pnpm å®˜ç½‘](https://pnpm.io/zh/motivation)ã€‚

::: details åŸç†å›¾

* èŠ‚çº¦ç£ç›˜ç©ºé—´å¹¶æå‡å®‰è£…é€Ÿåº¦

![](./images/pnpm1.jpeg)

* åˆ›å»ºéæ‰å¹³åŒ–çš„ node_modules æ–‡ä»¶å¤¹

![](./images/pnpm2.jpeg)
:::

> v7ç‰ˆæœ¬çš„pnpmå®‰è£…ä½¿ç”¨éœ€è¦nodeç‰ˆæœ¬è‡³å°‘å¤§äºv14ï¼Œæ‰€ä»¥åœ¨å®‰è£…ä¹‹å‰é¦–å…ˆéœ€è¦æ£€æŸ¥ä¸‹nodeç‰ˆæœ¬ã€‚

### åˆå§‹åŒ–é¡¹ç›®

```shell
# å…¨å±€å®‰è£…pnpm
npm i pnpm -g
mkdir "sysuke"
cd sysuke
pnpm init
```

![](./images/step1.png)

è¿™é‡Œ`package.json`æ–°å¢ä¸ªè„šæœ¬å’Œ2ä¸ªé…ç½®ï¼Œéå¿…é¡»ã€‚

- åªå…è®¸`pnpm`

å½“åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ `pnpm` æ—¶ï¼Œå¦‚æœä¸å¸Œæœ›ç”¨æˆ·ä½¿ç”¨ `yarn `æˆ–è€… `npm` å®‰è£…ä¾èµ–ï¼Œå¯ä»¥å°†ä¸‹é¢çš„è¿™ä¸ª `preinstall` è„šæœ¬æ·»åŠ åˆ°å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„ `package.json`ä¸­ï¼š

```shell
{
  "scripts": {
    "preinstall": "npx only-allow pnpm"
  }
}
```

`preinstall` è„šæœ¬ä¼šåœ¨ `install` ä¹‹å‰æ‰§è¡Œï¼Œç°åœ¨ï¼Œåªè¦æœ‰äººè¿è¡Œ `npm install` æˆ– `yarn install`ï¼Œå°±ä¼šè°ƒç”¨ `only-allow `å»é™åˆ¶åªå…è®¸ä½¿ç”¨ `pnpm` å®‰è£…ä¾èµ–ã€‚

- [engines](https://docs.npmjs.com/cli/v8/configuring-npm/package-json#engines): å¯ä»¥æŒ‡å®šé¡¹ç›®è¿è¡Œçš„ `node` ç‰ˆæœ¬
- [packageManager](https://nodejs.org/api/packages.html#packagemanager): é¡¹ç›®æœŸæœ›ç”¨ä»€ä¹ˆåŒ…ç®¡ç†å·¥å…·

```json
{
  "engines": {
    "node": ">=14.6",
    "npm": "please use pnpm",
    "yarn": "please use pnpm"
  },
  "packageManager": "pnpm@7.6.0"
}
```

::: details package.json ä¸å¸¸ç”¨å­—æ®µ

- [type](https://nodejs.org/api/packages.html#type): `type` å­—æ®µå®šä¹‰äº† `Node.js` ç”¨äºæ‰€æœ‰ä»¥ `package.json` æ–‡ä»¶ä½œä¸ºå…¶æœ€è¿‘çˆ¶çº§çš„ .js æ–‡ä»¶çš„æ¨¡å—æ ¼å¼ã€‚ å½“æœ€è¿‘çš„çˆ¶ `package.json` æ–‡ä»¶åŒ…å«å€¼ä¸º`module`çš„é¡¶çº§å­—æ®µ`type`æ—¶ï¼Œä»¥ `.js` ç»“å°¾çš„æ–‡ä»¶å°†ä½œä¸º `ES æ¨¡å—`åŠ è½½ã€‚
- `files`: æŒ‡å®šå‘å¸ƒåˆ° `npm`ä¸­çš„æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯æ‰€æœ‰æ–‡ä»¶`["*"]`ï¼Œä¹Ÿå¯ä»¥é€šè¿‡`.npmignore`é˜²æ­¢æŸäº›æ–‡ä»¶è¢«åŒ…å«åœ¨å†…ï¼Œå®ƒä¸ä¼šè¦†ç›–`files`å­—æ®µï¼Œä½†ä¼šè¦†ç›–å…¶å­ç›®å½•ã€‚ å¦‚æœä¸å­˜åœ¨`.npmignore`å°†ä½¿ç”¨`.gitignore`æ›¿ä»£ã€‚ä¸€èˆ¬æ¥è¯´npmä¸Šæˆ‘ä»¬åªéœ€è¦å‘å¸ƒæ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œå¯¹äºgitåˆ™æ°å¥½ç›¸åï¼Œæˆ‘ä»¬åªéœ€è¦æäº¤æºä»£ç ã€‚
- `peerdependencies`ï¼šè®¾ç½®åŒ…çš„ä¾èµ–é¡¹, `peerdependencies`è®¾ç½®çš„ä¾èµ–åŒ…è¡¨è¾¾æ‚¨çš„åŒ…ä¸ä¸»æœºå·¥å…·æˆ–åº“çš„å…¼å®¹æ€§ï¼Œ å¦‚ä½ å¼€å‘äº†ä¸€ä¸ª `vue` ç»„ä»¶åº“ï¼Œéœ€è¦æŒ‡å®šåœ¨vue 3.xç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œå¯ä»¥è¿™æ ·è®¾ç½®

```json
{
  "peerdependencies": {
    "vue": "^3.0"
  }
}
```

å¦‚æœç”¨æˆ·å®‰è£…äº†è¯¥ç»„ä»¶åº“ï¼Œå¹¶ä¸”å®‰è£…`peerdependencies`è®¾ç½®çš„ä¾èµ–åŒ…ä¸ç”¨æˆ·å®‰è£…çš„ä¾èµ–åŒ…æŒ‡å®šçš„ç‰ˆæœ¬ä¸ä¸€è‡´æ—¶ï¼Œnpm ä¼šæç¤º vue ç‰ˆæœ¬ä¸å…¼å®¹çš„ä¿¡æ¯

- module: æŒ‡å®šæ¨¡å—å…¥å£æ–‡ä»¶ï¼Œä¸åŒäº`main`å­—æ®µï¼Œå°†æŒ‡å‘ä¸€ä¸ªå…·æœ‰ ES2015 æ¨¡å—è¯­æ³•çš„æ¨¡å—å…¥å£æ–‡ä»¶ï¼Œä½ å¯ä»¥ä¸`main`å­—æ®µåŒæ—¶å‘½åï¼Œå½“ä½ ç”¨es6è¯­æ³•å¯¼å…¥æ—¶ï¼Œæ‰“åŒ…å·¥å…·ï¼ˆrollup,webpackï¼‰ä¼šä¼˜å…ˆä½¿ç”¨è¯¥å­—æ®µå¯¹åº”çš„å…¥å£æ–‡ä»¶ï¼Œ

```json
{
  "name": "my-package",
  "version": "0.1.0",
  "main": "dist/my-package.umd.js",
  "module": "dist/my-package.esm.js"
}
```

- exportsï¼šå­—æ®µå…è®¸å®šä¹‰åŒ…çš„å…¥å£ç‚¹ï¼Œå½“é€šè¿‡ `node_modules` æŸ¥æ‰¾æˆ–å¯¹å…¶è‡ªèº«åç§°çš„è‡ªå¼•ç”¨åŠ è½½çš„åç§°å¯¼å…¥æ—¶ã€‚ Node.js 12+ æ”¯æŒå®ƒä½œä¸ºâ€œmainâ€çš„æ›¿ä»£æ–¹æ¡ˆï¼Œ

```json
{
  "name": "a-package",
  "exports": {
    ".": "./main.mjs",
    "./foo": "./foo.js"
  }
}
```

å¹¶ä¸”exportsè¿˜æ”¯æŒæŒ‰æ¡ä»¶å¯¼å‡º

```json
{
  "type": "module",
  "main": "./index.cjs",
  "exports": {
    "import": "./wrapper.mjs",
    "require": "./index.cjs"
  }
}
```

:::

æ–°å»ºé…ç½®æ–‡ä»¶ `.npmrc`

```shell
registry=https://registry.npmjs.org/
# å¯è®¾ç½®ä¸ºæ·˜å®æºï¼Œä½†åé¢å‘å¸ƒä¼šæœ‰é—®é¢˜
registry=https://registry.npmmirror.com
auto-install-peers=false
```

`auto-install-peers`ä¸º`true`æ—¶å°†è‡ªåŠ¨å®‰è£…ä»»ä½•ç¼ºå°‘çš„éå¯é€‰åŒçº§ä¾èµ–å…³ç³»ã€‚

### monorepoçš„å®ç°ï¼š [workspace](https://pnpm.io/zh/workspaces)

æ ¹ç›®å½•åˆ›å»º`pnpm-workspace.yaml`

```yaml
packages:
  - "apps/**"
  - "packages/**"
  - "projects/**"
```

è¿™é‡Œå¦‚æœæ˜¯ `'packages/*'`, åªä¼šè¯†åˆ«ç›´æ¥å­ç›®å½•ä¸‹æ‰€æœ‰çš„åŒ…ï¼Œè€Œ`'packages/**`, 2ä¸ª`*`ä¼šè¯†åˆ«åˆ°åµŒå¥—çš„å­ç›®å½•ã€‚ è€Œ`'!**/test/**'`ä¼šæ’é™¤æ‰æ‰€æœ‰çš„`test`ç›®å½•ã€‚

åˆ›å»ºæ–‡ä»¶å¤¹ç›®å½•ç»“æ„

```md
â”œâ”€â”€ apps
â”‚   â”œâ”€â”€ web
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ docs
â”‚   â”‚   â”œâ”€â”€ package.json
â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ config
â”‚   â”‚   â”œâ”€â”€ eslint-config-custom
â”‚   â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig
â”‚   â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ ui
â”‚   |   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ util
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ webpack-react-base
â”‚   â”‚   â”œâ”€â”€ package.json
â”œâ”€â”€ projects
â”‚   |   â”œâ”€â”€ demo
â”‚   â”‚   |    â”œâ”€â”€ package.json
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-lock.yaml
â””â”€â”€ pnpm-workspace.yaml
```

è¿™é‡Œæ˜¯å› ä¸ºæˆ‘åé¢è¦åœ¨ä¸€ä¸ªä»“åº“ä¸­æ”¾æˆ‘æ‰€æœ‰çš„packageã€åº”ç”¨ç­‰ï¼Œæ¯”å¦‚ç»„ä»¶åº“ï¼Œè„šæ‰‹æ¶ç­‰ã€‚æ‰€ä»¥æœ‰çš„å±‚çº§è¾ƒæ·±ã€‚

::: details workspaceåè®®

#### [workspaceåè®®](https://pnpm.io/zh/workspaces)

é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¯ç”¨çš„ `packages` ä¸å·²å£°æ˜çš„å¯ç”¨èŒƒå›´ç›¸åŒ¹é…ï¼Œ`pnpm` å°†ä»å·¥ä½œç©ºé—´é“¾æ¥è¿™äº› `packages`ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœ`bar`ä¸­æœ‰`"foo"ï¼š"^1.0.0"`çš„è¿™ä¸ªä¾èµ–é¡¹ï¼Œåˆ™`foo@1.0.0`é“¾æ¥åˆ°`bar`ã€‚ ä½†æ˜¯ï¼Œå¦‚æœ`bar`çš„ä¾èµ–é¡¹ä¸­æœ‰`"foo": "2.0.0"`ï¼Œè€Œ`foo@2.0.0`åœ¨å·¥ä½œç©ºé—´ä¸­å¹¶ä¸å­˜åœ¨ï¼Œåˆ™å°†ä» `npm registry` å®‰è£…`foo@2.0.0`ï¼Œè¿™ç§è¡Œä¸ºå¸¦æ¥äº†ä¸€äº›ä¸ç¡®å®šæ€§ã€‚

`pnpm` æ”¯æŒ workspace åè®®ï¼ˆå†™æ³•ï¼š`workspace:<ç‰ˆæœ¬å·>`ï¼‰ã€‚ å½“ä½¿ç”¨æ­¤åè®®æ—¶ï¼Œ`pnpm` å°†æ‹’ç»è§£æé™¤æœ¬åœ° `workspace` åŒ…å«çš„ `package` ä¹‹å¤–çš„ä»»ä½•å†…å®¹ã€‚ å› æ­¤ï¼Œå¦‚æœè®¾ç½®ä¸º`"foo": "workspace:2.0.0"`æ—¶ï¼Œå®‰è£…å°†ä¼šå¤±è´¥ï¼Œå› ä¸º`"foo@2.0.0"`ä¸å­˜åœ¨äºæ­¤ `workspace` ä¸­ã€‚

#### åˆ«åå¼•ç”¨

å‡å¦‚å·¥ä½œåŒºæœ‰ä¸€ä¸ªåä¸º`foo`çš„åŒ…ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·å¼•ç”¨ `"foo": "workspace:"`ï¼Œå¦‚æœæ˜¯å…¶å®ƒåˆ«åï¼Œå¯ä»¥è¿™ä¹ˆå¼•ç”¨ï¼š`"bar": "workspace:foo@*"`ã€‚

#### ç›¸å¯¹å¼•ç”¨

å‡å¦‚`packages`ä¸‹æœ‰åŒå±‚çº§çš„fooã€barï¼Œå…¶ä¸­`bar`ä¾èµ–äº`foo`ï¼Œåˆ™å¯ä»¥å†™ä½œ`"bar": "workspace:../foo"`ã€‚

æ­¤å¤–è¿˜æœ‰å…³äºå¦‚ä½•`å‘å¸ƒ workspace åŒ…`, å‘å¸ƒå·¥ä½œæµç­‰ï¼Œå¯å‚è€ƒ[å®˜ç½‘](https://pnpm.io/zh/workspaces) ã€‚

:::

å…¶å®monorepoä¸‹çš„ç»“æ„è·Ÿæ™®é€šé¡¹ç›®çš„ç»“æ„å¤§åŒå°å¼‚ï¼Œä½†æ˜¯monorepoä¸‹é¢æœ‰ä¸€äº›éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ç‚¹ã€‚

aå’Œbåˆ†åˆ«ä¸ºmonorepoä¸‹çš„ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®aä¾èµ–äº†`lodash`å’Œ`@types/lodash`ï¼Œé¡¹ç›®bä¾èµ–äº†é¡¹ç›®aä»¥åŠ`react`ã€‚ç»“æ„çš„å¦‚ä¸‹ï¼š

```md

â”œâ”€â”€ node_modules

â”‚   â”œâ”€â”€@types

â”‚   â”‚ â””â”€â”€ lodash -> ../.pnpm/@types+lodash@4.14.177/node_modules/@types/lodash

|   |â€”â€”â€”.pnpm

â”œâ”€â”€ package.json

â”œâ”€â”€ packages

â”‚   â”œâ”€â”€ a

â”‚   â”‚   â”œâ”€â”€ node_modules

â”‚   â”‚   â”‚   â”œâ”€â”€ @types

â”‚               â””â”€â”€ lodash

â”‚   â”‚   â”‚   â””â”€â”€ lodash -> ../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash

â”‚   â”‚   â””â”€â”€ package.json

â”‚   â””â”€â”€ b

â”‚       â”œâ”€â”€ node_modules

â”‚       â”‚   â”œâ”€â”€ a -> ../../a

â”‚       â”‚   â””â”€â”€ react -> ../../../node_modules/.pnpm/react@17.0.2/node_modules/react

â”‚       â””â”€â”€ package.json

â”œâ”€â”€ pnpm-lock.yaml

â””â”€â”€ pnpm-workspace.yaml
```

å¯ä»¥çœ‹åˆ°ï¼š

- æ‰€æœ‰ä¾èµ–éƒ½å¹³é“ºåœ¨æœ€å¤–å±‚çš„`node_modules/.pnpm`è¿™ä¸ªç›®å½•ã€‚
- é¡¹ç›®bä¾èµ–çš„`react`ï¼Œå’Œé¡¹ç›®aä¾èµ–çš„`lodash`å’Œ`@types/lodash`éƒ½æŒ‡å‘äº†ä¸Šé¢è¿™ä¸ªç›®å½•å¯¹åº”çš„æ–‡ä»¶å¤¹ã€‚
- é€šè¿‡`worksapceåè®®`ï¼Œé¡¹ç›®bä¾èµ–æŒ‡å®šå…¶ä¾èµ–aä¸ºæœ¬åœ°é¡¹ç›®çš„aï¼Œç›´æ¥æŠŠ`node_modules/a`è½¯é“¾åˆ°äº†é¡¹ç›®açš„è·¯å¾„ã€‚

### ä¾èµ–ç®¡ç†

å¸¸è§çš„å‘½ä»¤ï¼š[å®˜ç½‘æŸ¥çœ‹æ›´å¤šå‘½ä»¤](https://pnpm.io/zh/cli/add)

è¿™é‡Œä¸»è¦åˆ—ä¸¾monorepoç®¡ç†packageçš„å‘½ä»¤

```shell
#  ä¸€é”®é€’å½’å®‰è£… https://pnpm.io/zh/cli/recursive
pnpm i -r
# ç§»é™¤æ‰€æœ‰åŒ…ä¸­çš„ lodash-es
pnpm remove lodash-es -r
# 1. å…¨å±€çš„å…¬å…±ä¾èµ–åŒ…
pnpm install typescript -w
# 2. ç»™æŸä¸ªpackageå•ç‹¬å®‰è£…æŒ‡å®šä¾èµ–
pnpm add axios --filter @apps/web
# 3. æ¨¡å—ä¹‹é—´çš„ç›¸äº’ä¾èµ–
pnpm install @sysuke/eslint-config-react @sysuke/tsconfig --filter @sysuke/webpack-react-base -D
# å®‰è£…åˆ°å¤šä¸ªé¡¹ç›®
 pnpm add mf-communication --filter="@mf.react-ts/*"
# ä¼šæ‰§è¡Œæ‰€æœ‰ package ä¸‹çš„ build å‘½ä»¤
pnpm build --filter "./packages/**"
# å¹¶è¡Œçš„è·‘appsæ‰€æœ‰çš„ dev å‘½ä»¤
pnpm -r --filter ./apps --parallel run dev
```

note:

- `-F`ç­‰ä»·äº`--filter`
- `--filter `å‚æ•°è·Ÿç€çš„æ˜¯packageä¸‹çš„ `package.json` çš„ `name` å­—æ®µï¼Œ**å¹¶ä¸æ˜¯ç›®å½•å**ã€‚
- `package` çš„version`*`ä»£è¡¨é»˜è®¤åŒæ­¥æœ€æ–°ç‰ˆæœ¬, è¿˜æ²¡æ‰¾åˆ°æ€ä¹ˆæŠŠåŒ…å®‰è£…æˆ`"@sysuke/eslint-config-base": "workspace:*",`æ ¼å¼ï¼Œæœ‰è¯´æ˜¯åœ¨æœ€å`@*`ï¼Œä½†è¯•äº†å‡ æ¬¡éƒ½æŠ¥é”™ã€‚

::: details more detail

ä½¿ç”¨`pnpm`å®‰è£…ä¾èµ–åŒ…ä¸€èˆ¬åˆ†ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š

- å…¨å±€çš„å…¬å…±ä¾èµ–åŒ…ï¼Œæ¯”å¦‚æ‰“åŒ…æ¶‰åŠåˆ°çš„`rollup`ã€`typescript`ç­‰ï¼Œä»£ç æ ·å¼ç¾åŒ–çš„`prettier`ç­‰ã€‚

`pnpm` æä¾›äº† [-w, --workspace-root](https://pnpm.io/zh/pnpm-cli#-w---workspace-root) å‚æ•°ï¼Œå¯ä»¥å°†ä¾èµ–åŒ…å®‰è£…åˆ°å·¥ç¨‹çš„æ ¹ç›®å½•ä¸‹ï¼Œä½œä¸ºæ‰€æœ‰ package çš„å…¬å…±ä¾èµ–ã€‚

æ¯”å¦‚ï¼š

```shell
pnpm install typescript -w
```

å¦‚æœæ˜¯ä¸€ä¸ªå¼€å‘ä¾èµ–çš„è¯ï¼Œå¯ä»¥åŠ ä¸Š -D å‚æ•°ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¼€å‘ä¾èµ–ï¼Œä¼šè£…åˆ° pacakage.json ä¸­çš„ devDependencies ä¸­

- ç»™æŸä¸ªpackageå•ç‹¬å®‰è£…æŒ‡å®šä¾èµ–

  pnpm æä¾›äº† [--filter](https://pnpm.io/zh/filtering) å‚æ•°ï¼Œå¯ä»¥ç”¨æ¥å¯¹ç‰¹å®šçš„packageè¿›è¡ŒæŸäº›æ“ä½œã€‚
  å¦‚æœæƒ³ç»™ pkg1 å®‰è£…ä¸€ä¸ªä¾èµ–åŒ…ï¼Œæ¯”å¦‚ axiosï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š

```shell
pnpm add axios --filter @apps/web
```

`--filter `å‚æ•°è·Ÿç€çš„æ˜¯packageä¸‹çš„ package.json çš„ `name` å­—æ®µï¼Œ**å¹¶ä¸æ˜¯ç›®å½•å**ã€‚

è¿˜å¯ä»¥æ ¹æ®`--filter `æ‰§è¡Œå¯¹åº”åŒ…ä¸‹çš„æ‰€æœ‰æ“ä½œï¼Œåªæ˜¯æ¯”å•ä¸ªé¡¹ç›®å¤šåŠ çš„å‚æ•°ï¼Œæ¯”å¦‚`pnpm build --filter @apps/web`ã€‚ä¹Ÿæ”¯æŒæ‰¹é‡æ‰§è¡Œ`$ pnpm build --filter "./packages/**"`

- æ¨¡å—ä¹‹é—´çš„ç›¸äº’ä¾èµ–

  æ¯”å¦‚ pkg1 ä¸­å°† pkg2 ä½œä¸ºä¾èµ–è¿›è¡Œå®‰è£…ã€‚åŸºäº pnpm æä¾›çš„ `workspace:åè®®`ï¼Œå¯ä»¥æ–¹ä¾¿çš„åœ¨ packages å†…éƒ¨è¿›è¡Œäº’ç›¸å¼•ç”¨ã€‚æ¯”å¦‚åœ¨ pkg1 ä¸­å¼•ç”¨ pkg2ï¼š

```shell
pnpm install @sysuke/pkg1 --filter @sysuke/pkg2
```

åœ¨è®¾ç½®ä¾èµ–ç‰ˆæœ¬çš„æ—¶å€™æ¨èç”¨ `workspace:*`ï¼Œè¿™æ ·å°±å¯ä»¥ä¿æŒä¾èµ–çš„ç‰ˆæœ¬æ˜¯å·¥ä½œç©ºé—´é‡Œæœ€æ–°ç‰ˆæœ¬ï¼Œä¸éœ€è¦æ¯æ¬¡æ‰‹åŠ¨æ›´æ–°ä¾èµ–ç‰ˆæœ¬ã€‚

å½“ `pnpm publish` çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å°† package.json ä¸­çš„ workspace ä¿®æ­£ä¸ºå¯¹åº”çš„ç‰ˆæœ¬å·ã€‚
:::

### what else?

è¿™æ ·å…¶å®ä¸€ä¸ªåªæ˜¯æ¶‰åŠä¾èµ–ç›¸äº’å¼•ç”¨å’ŒåŒ…ç®¡ç†çš„åŸºç¡€`monorepo`å·¥ç¨‹å°±æå®šäº†ï¼Œæ¯”å¦‚ä¸€äº›å†å²å·¥ç¨‹çš„è¿ç§»ï¼Œç›´æ¥`copy`åˆ°`apps`ï¼Œå¤ç”¨å…¨å±€çš„é…ç½®ï¼Œå¦‚`husky,commitlint`ç­‰ï¼Œåˆ é™¤å¤šä½™çš„é…ç½®å’Œä¾èµ–ï¼Œé‡æ–°å®‰è£…å³å¯ã€‚ä½†è¦æƒ³åšå¥½ä¸€ä¸ªå®Œæ•´çš„`monorepo`å·¥ç¨‹ï¼Œè¿œä¸æ­¢å¦‚æ­¤ã€‚åŒ…æ‹¬ï¼š

- å¦‚ä½•åˆç†çš„æŠ½å–eslintã€tsconfigé…ç½®
- æµ‹è¯•ç¯å¢ƒçš„å…¨å±€é…ç½®
- éœ€è¦å‘å¸ƒåˆ°npmä¸Šçš„åŒ…çš„å‘å¸ƒå·¥ä½œæµ
- å…¨å±€çš„å‘½ä»¤å¦‚ä½•å†™æ‰åˆé€‚
- ä¾èµ–çš„åŒ…å¦‚ä½•ç®¡ç†ï¼Œæ„å»ºå‘å¸ƒ
- ç¼“å­˜å¦‚ä½•å¤ç”¨ç­‰

#### eslint

Either start with `eslint-config-` or `@SCOPE/eslint-config.`

æ¯”å¦‚æˆ‘çš„eslint package nameä¸º`@sysuke/eslint-config`, å°±å¯ä»¥extend`sysuke`æˆ–è€…`eslint-config-sysuke`

#### husky + commitlint + lint-staged

è¿™å‡ ä¸ªæ¯”è¾ƒç®€å•ï¼Œå®‰è£…åï¼Œå†æŠŠé…ç½®æåˆ°rootã€‚

```shell
pnpm add husky lint-staged @commitlint/cli @commitlint/config-conventional  -w -D
```

### Releaseå·¥ä½œæµ

ä¸€èˆ¬å‘ä¸€ä¸ªåŒ…ï¼Œåªéœ€è¦åœ¨å¾…å‘å¸ƒé¡¹ç›®ç›®å½•ï¼Œ`npm login` + `npm publish`ï¼Œæ›´æ–°ä¹Ÿæ˜¯ä¸€æ ·ã€‚
ä½†æ¯æ¬¡åŒ…ï¼ˆPackageï¼‰çš„å‘å¸ƒï¼Œéœ€è¦ä¿®æ”¹ `package.json` çš„ `version` å­—æ®µï¼Œä»¥åŠåŒæ­¥æ›´æ–°ä¸€ä¸‹æœ¬æ¬¡å‘å¸ƒä¿®æ”¹çš„ `CHANGELOG.md`ã€‚

è€Œåœ¨ `workspace` ä¸­å¯¹åŒ…ç‰ˆæœ¬ç®¡ç†æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„å·¥ä½œï¼ˆä¼šå­˜åœ¨ä¾èµ–é“¾çš„é—®é¢˜ï¼‰ï¼Œé—æ†¾çš„æ˜¯ `pnpm` æ²¡æœ‰æä¾›å†…ç½®çš„è§£å†³æ–¹æ¡ˆï¼Œä¸€éƒ¨åˆ†å¼€æºé¡¹ç›®åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­è‡ªå·±å®ç°äº†ä¸€å¥—åŒ…ç‰ˆæœ¬çš„ç®¡ç†æœºåˆ¶ï¼Œæ¯”å¦‚ [Vue3](https://github.com/vuejs/vue-next) ã€[Vite](https://github.com/vitejs/vite/blob/main/scripts/release.ts) ç­‰ã€‚
`pnpm` æ¨èäº†ä¸¤ä¸ªå¼€æºçš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼š

- [changesets](https://github.com/changesets/changesets)
- [rush](https://rushjs.io/)

è¿™é‡Œé‡‡ç”¨äº† `changesets` æ¥åšä¾èµ–åŒ…çš„ç®¡ç†ã€‚é€‰ç”¨ `changesets` çš„ä¸»è¦åŸå› è¿˜æ˜¯æ–‡æ¡£æ›´åŠ æ¸…æ™°ä¸€äº›ï¼Œä¸ªäººæ„Ÿè§‰ä¸Šæ‰‹æ¯”è¾ƒå®¹æ˜“ã€‚è€Œ`rushjs` ä¸æ­¢äºç®¡ç†releaseï¼ˆrushæ˜¯ä¸ºå¤§å‹å›¢é˜Ÿå‡†å¤‡çš„ï¼Œå®ƒå¯ä»¥ç»™ä½ æä¾›ä¸€ä¸ªä»“åº“ä¸‹ç»´æŠ¤å¤šä¸ªé¡¹ç›®çš„æ„å»ºå’Œå‘å¸ƒæ–¹æ¡ˆã€‚ï¼‰ï¼Œ

æŒ‰ç…§ `changesets` æ–‡æ¡£ä»‹ç»çš„ï¼Œ`changesets`ä¸»è¦æ˜¯åšäº†ä¸¤ä»¶äº‹ï¼š

> Changesets hold two key bits of information: a version type (following semver), and change information to be added to a changelog.

ç®€è€Œè¨€ä¹‹å°±æ˜¯ç”¨äºç®¡ç†ç‰ˆæœ¬åŠå˜æ›´æ—¥å¿—`changelog`çš„å·¥å…·ï¼Œä¸“æ³¨å¤šåŒ…ç®¡ç†ã€‚
ç”Ÿæˆçš„ `changelog` éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬ 2.0.0](https://semver.org/lang/zh-CN/)ï¼Œå…·ä½“çš„åšæ³•æ˜¯å…ˆæ ¹æ®ä½ çš„ä»£ç æ›´æ”¹ç”Ÿæˆ `changeset` æ–‡ä»¶ï¼Œç„¶åå‘ç‰ˆçš„æ—¶å€™åˆå¹¶è¿™äº› `changeset` æ–‡ä»¶ã€æ›´æ”¹ç‰ˆæœ¬å·ã€ç”Ÿæˆ `changelog`ã€‚

![](./images/changeset-flow.png)

* å®‰è£…

```shell
# å®‰è£…
pnpm add -Dw @changesets/cli @changesets/changelog-github
# åˆå§‹åŒ–
pnpm changeset init
```

`@changesets/changelog-github` æ˜¯ä¸€ä¸ªç”Ÿæˆ `changelog` çš„æ’ä»¶ï¼Œå¦‚æœä¸ä¿®æ”¹è¿™ä¸ªé…ç½®ä¹Ÿå¯ä»¥å·¥ä½œï¼Œä½†æ˜¯ç”Ÿæˆçš„ `changelog` ä¸å¤ªå®Œç¾ï¼

![](./images/changeset-init.png)

æ‰§è¡Œå®Œåˆå§‹åŒ–å‘½ä»¤åï¼Œä¼šåœ¨å·¥ç¨‹çš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆ `.changeset` ç›®å½•ï¼Œå…¶ä¸­çš„ `config.json` ä½œä¸ºé»˜è®¤çš„ `changeset` çš„é…ç½®æ–‡ä»¶ã€‚

é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š

```json
{
  "$schema": "https://unpkg.com/@changesets/config@2.1.1/schema.json",
  "changelog": "@changesets/cli/changelog",
  "commit": false,
  "fixed": [],
  "linked": [],
  "access": "restricted",
  "baseBranch": "main",
  "updateInternalDependencies": "patch",
  "ignore": []
}
```

[è¯´æ˜](https://github.com/changesets/changesets/blob/main/docs/config-file-options.md) å¦‚ä¸‹ï¼š

- changelog: è®¾ç½® `CHANGELOG.md` ç”Ÿæˆæ–¹å¼ï¼Œå¯ä»¥è®¾ç½® `false` ä¸ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå®šä¹‰ç”Ÿæˆè¡Œä¸ºçš„æ–‡ä»¶åœ°å€æˆ–ä¾èµ–åç§°ã€‚

æ·»åŠ   `@changesets/changelog-github`åä¿®æ”¹

```json5
{
  "changelog": [
    "@changesets/changelog-github",
    {
      "repo": "qinsong77/sysuke" // æ”¹ä¸ºä½ çš„ github ä»“å‚¨
    }
  ],
}
```

- commit: è®¾ç½®æ˜¯å¦æŠŠæ‰§è¡Œ `changeset add `æˆ– `changeset version` æ“ä½œæ—¶å¯¹ä¿®æ”¹ç”¨ `git` è‡ªåŠ¨æäº¤å¯¹åº”æ–‡ä»¶ã€‚(A GitHub token with repo, write:packages permissions)
- linked: è®¾ç½®å…±äº«ç‰ˆæœ¬çš„åŒ…ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹ç‰ˆæœ¬çš„åŒ…ï¼Œä¾‹å¦‚ä¸€ä¸ªç»„ä»¶åº“ä¸­ä¸»é¢˜å’Œå•ç‹¬çš„ç»„ä»¶çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹ Version çš„æ—¶å€™ï¼Œå…±äº«çš„åŒ…éœ€è¦åŒæ­¥ä¸€èµ·æ›´æ–°ç‰ˆæœ¬
- [fixed](https://github.com/changesets/changesets/blob/main/docs/fixed-packages.md): è®¾ç½®é‚£äº›åŒ…çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´çš„æ›´æ–°
- access: å…¬ç§æœ‰å®‰å…¨è®¾å®šï¼Œå†…ç½‘å»ºè®® `restricted` ï¼Œå¼€æºä½¿ç”¨ `public`
- baseBranch: è®¾ç½®é»˜è®¤çš„ Git åˆ†æ”¯ï¼Œä¾‹å¦‚ç°åœ¨ GitHub çš„é»˜è®¤åˆ†æ”¯åº”è¯¥æ˜¯ `main`
- updateInternalDependencies: è®¾ç½®äº’ç›¸ä¾èµ–çš„åŒ…ç‰ˆæœ¬æ›´æ–°æœºåˆ¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼ˆ`major|minor|patch`ï¼‰ï¼Œä¾‹å¦‚è®¾ç½®ä¸º minor æ—¶ï¼Œåªæœ‰å½“ä¾èµ–çš„åŒ…æ–°äº†`minor` ç‰ˆæœ¬æˆ–è€…æ‰ä¼šå¯¹åº”åœ°æ›´æ–° `package.json` çš„ `dependencies` æˆ– `devDependencies` ä¸­å¯¹åº”ä¾èµ–çš„ç‰ˆæœ¬
- ignore: è®¾ç½®ä¸éœ€è¦å‘å¸ƒçš„åŒ…ï¼Œè¿™äº›ä¼šè¢« `changesets` å¿½ç•¥

åœ¨åˆå§‹åŒ– `.changeset` æ–‡ä»¶å¤¹åï¼Œå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ `changeset` ç›¸å…³çš„å‘½ä»¤ï¼Œä¸»è¦æ˜¯è¿™ 3 ä¸ªå‘½ä»¤ï¼š

- `chageset/npx changeset` å¼€å§‹äº¤äº’å¼å¡«å†™å˜æ›´é›†ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå°†ä½ çš„åŒ…å…¨éƒ¨åˆ—å‡ºæ¥ï¼Œç„¶åé€‰æ‹©ä½ è¦æ›´æ”¹å‘å¸ƒçš„åŒ…, ç”¨äºç”Ÿæˆæœ¬æ¬¡ä¿®æ”¹çš„è¦æ·»åŠ åˆ° `CHANGELOG.md` ä¸­çš„æè¿°
- `changeset version` ç”¨äºç”Ÿæˆæœ¬æ¬¡ä¿®æ”¹åçš„åŒ…çš„ç‰ˆæœ¬
- `changeset publish` ç”¨äºå‘å¸ƒåŒ…

`changeset version`æ”¹å‘½ä»¤å°±æ˜¯æ¥ä¿®æ”¹å‘å¸ƒåŒ…çš„ç‰ˆæœ¬çš„ã€‚é‡Œé¢å¯¹åº”äº†è¿™æ ·å‡ ä¸ªç‰ˆæœ¬çº¦æŸï¼ˆç‰ˆæœ¬å·æŒ‰0.0.0è¿™æ ·çš„ä¸‰æ®µå¼,ä¸¥æ ¼éµå¾ª [semver](https://semver.org/) è§„èŒƒã€‚ï¼‰ï¼š

- patch æ›´æ–°å°ç‰ˆæœ¬å·ï¼Œä»£è¡¨fixè¡¥ä¸
- minor æ›´æ–°ä¸­ç‰ˆæœ¬å·ï¼Œä»£è¡¨å°åŠŸèƒ½æ”¹åŠ¨
- major æ›´æ–°å¤§ç‰ˆæœ¬å·ï¼Œä»£è¡¨åŠŸèƒ½å¤§è·¨æ­¥å‡çº§

æ­¤å¤–ï¼Œå¦‚æœæ˜¯åœ¨ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æŠŠåŒ…å‘åˆ°å…¬å¸ç§æœ‰çš„ `NPM Registry`ï¼Œè€Œè¿™æœ‰å¾ˆå¤šç§é…ç½®æ–¹å¼ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ changesets åªæ”¯æŒåœ¨æ¯ä¸ªåŒ…ä¸­å£°æ˜ publicConfig.registry æˆ–è€…é…ç½® process.env.npm_config_registryï¼Œå¯¹åº”çš„ä»£ç ä¼šæ˜¯è¿™æ ·ï¼š

```ts
// https://github.com/changesets/changesets/blob/main/packages/cli/src/commands/publish/npm-utils.ts
function getCorrectRegistry(packageJson?: PackageJSON): string {
  const registry =
    packageJson?.publishConfig?.registry ?? process.env.npm_config_registry;

  return !registry || registry === "https://registry.yarnpkg.com"
    ? "https://registry.npmjs.org"
    : registry;
}
```

å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœåœ¨å‰é¢è¯´çš„è¿™2ç§æƒ…å†µä¸‹è·å–ä¸åˆ° `registry` çš„è¯ï¼ŒChangesets éƒ½æ˜¯æŒ‰å…¬å…±çš„ Registry å»æŸ¥æ‰¾æˆ–è€…å‘å¸ƒåŒ…çš„ã€‚

è¿™é‡Œè¿˜æœ‰ä¸ªç»†èŠ‚ï¼Œå¦‚æœæˆ‘ä¸æƒ³ç›´æ¥å‘ release ç‰ˆæœ¬ï¼Œè€Œæ˜¯æƒ³å…ˆå‘ä¸€ä¸ªå¸¦ tag çš„ prereleaseç‰ˆæœ¬å‘¢(æ¯”å¦‚betaæˆ–è€…rcç‰ˆæœ¬)ï¼Ÿ

è¿™é‡Œæä¾›äº†ä¸¤ç§æ–¹å¼ï¼š

- æ‰‹å·¥è°ƒæ•´

è¿™ç§æ–¹æ³•æœ€ç®€å•ç²—æš´ï¼Œä½†æ˜¯æ¯”è¾ƒå®¹æ˜“çŠ¯é”™ã€‚ é¦–å…ˆéœ€è¦ä¿®æ”¹åŒ…çš„ç‰ˆæœ¬å·ï¼š

```json
{
  "name": "@sysuke/pkg1",
  "version": "1.0.2-beta.1"
}
```

ç„¶åè¿è¡Œï¼š `pnpm changeset publish --tag beta`ï¼Œæ³¨æ„å‘åŒ…çš„æ—¶å€™ä¸è¦å¿˜è®°åŠ ä¸Š`--tag` å‚æ•°ã€‚

- é€šè¿‡ `changeset` æä¾›çš„ [`Prereleases` æ¨¡å¼](https://github.com/changesets/changesets/blob/main/docs/prereleases.md) ,å¯ä»¥é€šè¿‡ `pre enter <tag> `å‘½ä»¤è¿›å…¥å…ˆè¿›å…¥ `pre `æ¨¡å¼ã€‚

å¸¸è§çš„tagå¦‚ä¸‹æ‰€ç¤ºï¼š


| åç§°  | åŠŸèƒ½                                                                                     |
| ----- | ---------------------------------------------------------------------------------------- |
| alpha | æ˜¯å†…éƒ¨æµ‹è¯•ç‰ˆï¼Œä¸€èˆ¬ä¸å‘å¤–éƒ¨å‘å¸ƒï¼Œä¼šæœ‰å¾ˆå¤šBugï¼Œä¸€èˆ¬åªæœ‰æµ‹è¯•äººå‘˜ä½¿ç”¨                        |
| beta  | ä¹Ÿæ˜¯æµ‹è¯•ç‰ˆï¼Œè¿™ä¸ªé˜¶æ®µçš„ç‰ˆæœ¬ä¼šä¸€ç›´åŠ å…¥æ–°çš„åŠŸèƒ½ã€‚åœ¨Alphaç‰ˆä¹‹åæ¨å‡º                          |
| rc    | Releaseã€€Candidate) ç³»ç»Ÿå¹³å°ä¸Šå°±æ˜¯å‘è¡Œå€™é€‰ç‰ˆæœ¬ã€‚RCç‰ˆä¸ä¼šå†åŠ å…¥æ–°çš„åŠŸèƒ½äº†ï¼Œä¸»è¦ç€é‡äºé™¤é”™ |

```shell
pnpm changeset pre enter beta
```

ä¹‹ååœ¨æ­¤æ¨¡å¼ä¸‹çš„ `changeset publish`  å‡å°†é»˜è®¤èµ° `beta` ç¯å¢ƒï¼Œä¸‹é¢åœ¨æ­¤æ¨¡å¼ä¸‹ä»»æ„åœ°è¿›è¡Œä½ çš„å¼€å‘ã€‚
å®Œæˆç‰ˆæœ¬å‘å¸ƒä¹‹åï¼Œé€€å‡º `Prereleases` æ¨¡å¼ï¼š

```shell
pnpm changeset pre exit
```

æ„å»ºäº§ç‰©åå‘ç‰ˆæœ¬

```shell
{
  "release": "pnpm build && pnpm release:only",
  "release:only": "changeset publish --registry=https://registry.npmjs.com/"
}
```

å¦‚æœç”¨æˆ·æƒ³æŸ¥çœ‹å½“å‰çš„ `changesets` æ–‡ä»¶æ¶ˆè€—çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ `changeset status` å‘½ä»¤ã€‚

##### what else?

ä¸šåŠ¡é¡¹ç›®å‘å¸ƒæµæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ

- ä¸åŒå¼€å‘è€…å…ˆå¼€å‘ï¼Œåœ¨æäº¤ PR æ—¶ä½¿ç”¨ `pnpm changeset` å†™å…¥ä¸€ä»½å˜æ›´é›†
- å®šæœŸé¡¹ç›® owner å‘åŒ…ï¼Œä½¿ç”¨ `changeset version` æ¶ˆè€—æ‰€æœ‰å˜æ›´é›†ï¼Œç”± `changesets` è‡ªåŠ¨æå‡å­åŒ…ç‰ˆæœ¬ã€ç”Ÿæˆ changelog
- æ‰§è¡Œ `pnpm release`(build package + `changeset publish`) æ„å»ºå…¨éƒ¨é¡¹ç›®å¹¶å‘åŒ…

å¼€æºé¡¹ç›®å‘å¸ƒæµæ˜¯æ€æ ·çš„ï¼Ÿ

- ç”± github bot å¸®åŠ©ï¼Œæ¯ä½å¼€å‘è€… PR å‰æäº¤ä¸€ä»½å˜æ›´é›†
- ç”± github bot å¸®åŠ©ï¼Œé¡¹ç›® owner å®šæœŸç‚¹å‡»åˆå…¥ bot æå‡ºçš„ å‘ç‰ˆ PR ï¼Œä¸€é”®åˆå…¥æå‡ç‰ˆæœ¬ï¼Œç”Ÿæˆ changelog
- ç”± github actions å¸®åŠ©ï¼Œå½“ å‘ç‰ˆ PR è¢«åˆå…¥æ—¶ï¼Œè‡ªåŠ¨å‘åŒ…åˆ° npm

`changeset version` å’Œ`changeset pubulish` å¯ä»¥äº¤ç»™`git-action`å®Œæˆï¼Œå¯å‚è€ƒ[repo](https://github.com/vercel/turborepo/tree/main/examples/design-system)

å¯ä»¥çœ‹åˆ°ï¼Œå‘ç‰ˆæ—¶é¡¹ç›® owner åšäº†ä»€ä¹ˆï¼Ÿç‚¹å‡»å‡ ä¸‹é¼ æ ‡ ğŸ˜… ï¼Œä½†æ˜¯ changelog ã€ç‰ˆæœ¬æå‡ã€å‘åŒ… å´ä¸€ç‚¹æ²¡å°‘ï¼Œæ˜¯çœŸçš„å¾ˆ niceã€‚

`npm unpublish  @sysuke/eslint-config-react --force` æ’¤é”€å‘å¸ƒçš„åŒ…ã€‚ï¼ˆä¸åŠ forceæœ‰é™åˆ¶ï¼šåªèƒ½åˆ é™¤72å°æ—¶ä»¥å†…å‘å¸ƒçš„åŒ…ï¼Œåˆ é™¤çš„åŒ…ï¼Œåœ¨24å°æ—¶å†…ä¸å…è®¸é‡å¤å‘å¸ƒï¼‰,å¦‚æœè¢«å…¶ä»–å‘å¸ƒä¸Šå»çš„åŒ…ä¾èµ–çš„è¯ï¼Œå°±åˆ é™¤ä¸äº†ã€‚

## [TurboRepo](https://turborepo.org/)

![](./images/turborepo.png)

Turbrepo åˆ™æ˜¯ [Vercel](https://vercel.com/) æ——ä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚ Turborepo æ˜¯ä¸€ä¸ªç”¨äº JavaScript å’Œ TypeScript ä»£ç åº“çš„é«˜æ€§èƒ½æ„å»ºç³»ç»Ÿã€‚é€šè¿‡å¢é‡æ„å»ºã€æ™ºèƒ½è¿œç¨‹ç¼“å­˜å’Œä¼˜åŒ–çš„ä»»åŠ¡è°ƒåº¦ï¼ŒTurborepo å¯ä»¥å°†æ„å»ºé€Ÿåº¦æé«˜ 85% æˆ–æ›´å¤šï¼Œä½¿å„ç§è§„æ¨¡çš„å›¢é˜Ÿéƒ½èƒ½å¤Ÿç»´æŠ¤ä¸€ä¸ªå¿«é€Ÿæœ‰æ•ˆçš„æ„å»ºç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå¯ä»¥éšç€ä»£ç åº“å’Œå›¢é˜Ÿçš„æˆé•¿è€Œæ‰©å±•ã€‚

### ä»€ä¹ˆæ˜¯monorepo

Monorepoæ˜¯ä¸€ç§é¡¹ç›®ç®¡ç†æ–¹å¼ï¼Œåœ¨Monorepoä¹‹å‰ï¼Œä»£ç ä»“åº“ç®¡ç†æ–¹å¼æ˜¯ MultiRepoï¼Œå³æ¯ä¸ªé¡¹ç›®éƒ½å¯¹åº”ç€ä¸€ä¸ªå•ç‹¬çš„ä»£ç ä»“åº“æ¯ä¸ªé¡¹ç›®è¿›è¡Œåˆ†æ•£ç®¡ç†ã€‚è¿™å°±ä¼šå¯¼è‡´è®¸å¤šå¼Šç«¯ï¼Œä¾‹å¦‚å¯èƒ½æ¯ä¸ªé¡¹ç›®çš„åŸºå»ºä»¥åŠå·¥å…·åº“éƒ½æ˜¯å·®ä¸å¤šçš„ï¼ŒåŸºç¡€ä»£ç çš„é‡å¤å¤ç”¨é—®é¢˜ç­‰ç­‰...

Monorepoå°±æ˜¯æŠŠå¤šä¸ªé¡¹ç›®æ”¾åœ¨ä¸€ä¸ªä»“åº“é‡Œé¢, å…³äºmonorepoçš„æ–‡ç« å·²ç»å¾ˆå¤šäº†ï¼Œå¹¶ä¸”ç›®å‰å¯ä»¥æ­å»ºMonorepoçš„å·¥å…·ä¹Ÿå¾ˆå¤šï¼Œä¾‹å¦‚ï¼š


| å·¥å…·                                | ç®€è¿°                                                   |
| ----------------------------------- | ------------------------------------------------------ |
| [Bit](https://bit.dev/)             | ç”¨äºç»„ä»¶é©±åŠ¨å¼€å‘çš„å·¥å…·é“¾                               |
| [TurboRepo](https://turborepo.org/) | ç”¨äº JavaScript å’Œ TypeScript ä»£ç åº“çš„é«˜æ€§èƒ½æ„å»ºç³»ç»Ÿã€‚ |
| [Rush](https://rushjs.io/)          | ä¸€ä¸ªå¯æ‰©å±•çš„ web å•ä»“åº“ç®¡ç†å™¨ã€‚                        |
| [Nx](https://nx.dev/)               | å…·æœ‰ä¸€æµçš„ monorepo æ”¯æŒå’Œå¼ºå¤§é›†æˆçš„ä¸‹ä¸€ä»£æ„å»ºç³»ç»Ÿã€‚   |
| [Lerna](https://lerna.js.org/)      | ç”¨äºç®¡ç†åŒ…å«å¤šä¸ªè½¯ä»¶åŒ…çš„é¡¹ç›®                           |

ä»¥ä¸Šå‡ ä¸ªï¼Œä¸ªäººéƒ½æœ‰äº›å°è¯•ï¼Œé¡¹ç›®ä¸­ä¹Ÿç”¨è¿‡lernaå’Œnxï¼Œæˆ‘ç†è§£`Lerna`å…¶å®æŒºé€‚åˆç”¨æ¥ç®¡ç†å‘åŒ…çš„ï¼Œæ¯”è¾ƒçº¯ç²¹ï¼Œ`nx`é›†æˆæ¥å¤ªå¤šçš„åŠŸèƒ½å’Œé…ç½®ï¼Œç±»ä¼¼ä¸reactä¸­çš„`umi.js`ï¼Œé€‚åˆä¸å¿«é€Ÿæ­å»ºè·‘èµ·é¡¹ç›®ï¼Œä½†å½“å‡ºäº†é—®é¢˜æˆ–è€…æœ‰è‡ªå®šä¹‰åŠŸèƒ½çš„é€‚åˆï¼Œå°±ä¸å¥½æ“ä½œäº†ï¼Œ
æ–‡æ¡£ä¸å…¨ï¼Œæœ‰æ—¶è¿˜è¦æ·±å…¥æºç ï¼Œè¿™æ—¶æ€§ä»·æ¯”åè€Œä¸é«˜ã€‚è‡³äº`bit`ç†è§£å¯ç”¨äºå¾®å‰ç«¯çš„åœºæ™¯ï¼Œè€ŒRushæœ‰ç‚¹å¤æ‚ï¼Œä¸å¤ªæ¨èã€‚è¿˜å¥½æœ€è¿‘å‰ç«¯çš„ç¿˜æ¥šVercelæ¨å‡ºäº†`TurboRepo`ï¼Œä¹Ÿå¿«ä¸€å¹´äº†ï¼Œç‰ˆæœ¬æ¥åˆ°äº†1.5ï¼Œ åŸºæœ¬æ²¡å•¥bugå¯ä»¥ç”¨äº†ï¼Œä¸ºå•¥åçˆ±è¿™ä¸ªï¼Œæˆ‘å°±æ˜¯è§‰å¾—å®ƒé…ç½®æ¯”è¾ƒç®€å•ï¼ŒåŠŸèƒ½çº¯ç²¹ï¼Œå¯¹
æœ¬èº«monorepoä¸‹çš„ä»£ç å…¥ä¾µå°ï¼Œå³TurborepoæŠ½è±¡å‡ºæ‰€æœ‰çƒ¦äººçš„é…ç½®ã€è„šæœ¬å’Œå·¥å…·ï¼Œå‡å°‘é¡¹ç›®é…ç½®çš„å¤æ‚æ€§ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä¸“æ³¨äºä¸šåŠ¡çš„å¼€å‘ï¼Œæ¯”è¾ƒå¹²å‡€çš„èƒ½å®ç°åŒ…æˆ–è€…åº”ç”¨æ„å»ºæ—¶çš„ä»»åŠ¡ç¼–æ’ï¼Œå¢é‡æ„å»ºï¼Œç¼“å­˜ç­‰ï¼Œè€Œä¸”åŸºäºgoï¼Œè¿˜å¿«ã€‚

ä¸€ä¸ªmonorepoå·¥å…·é™¤äº†æœ€åŸºæœ¬çš„ä»£ç å…±äº«èƒ½åŠ›å¤–ï¼Œè¿˜åº”å½“è‡³å°‘å…·å¤‡ä¸‰ç§èƒ½åŠ›ï¼Œå³ï¼š

1. ä¾èµ–ç®¡ç†èƒ½åŠ›ã€‚éšç€ä¾èµ–æ•°é‡çš„å¢åŠ ï¼Œä¾æ—§èƒ½å¤Ÿä¿æŒä¾èµ–ç»“æ„çš„æ­£ç¡®æ€§ã€ç¨³å®šæ€§ä»¥åŠå®‰è£…æ•ˆç‡ã€‚
2. ä»»åŠ¡ç¼–æ’èƒ½åŠ›ã€‚èƒ½å¤Ÿä»¥æœ€å¤§çš„æ•ˆç‡ä»¥åŠæ­£ç¡®çš„é¡ºåºæ‰§è¡Œ Monorepo å†…é¡¹ç›®çš„ä»»åŠ¡ï¼ˆå¯ä»¥ç‹­ä¹‰ç†è§£ä¸º `npm scripts`ï¼Œå¦‚ buildã€test ä»¥åŠ lint ç­‰ï¼‰ï¼Œä¸”å¤æ‚åº¦ä¸ä¼šéšç€ Monorepo å†…é¡¹ç›®å¢å¤šè€Œå¢åŠ ã€‚
3. ç‰ˆæœ¬å‘å¸ƒèƒ½åŠ›ã€‚èƒ½å¤ŸåŸºäºæ”¹åŠ¨çš„é¡¹ç›®ï¼Œç»“åˆé¡¹ç›®ä¾èµ–å…³ç³»ï¼Œæ­£ç¡®åœ°è¿›è¡Œç‰ˆæœ¬å·å˜æ›´ã€CHANGELOG ç”Ÿæˆä»¥åŠé¡¹ç›®å‘å¸ƒã€‚

åŸºäºæ­¤ï¼Œä¸€äº›æµè¡Œå·¥å…·çš„æ”¯æŒèƒ½åŠ›å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š



| -              | ä¾èµ–ç®¡ç†     | ä»»åŠ¡ç¼–æ’ | ç‰ˆæœ¬ç®¡ç† |
| -------------- | ------------ | -------- | -------- |
| Pnpm Workspace | yes          | yes      | no       |
| Rush           | yes(by Pnpm) | yes      | yes      |
| Lage           | no           | yes      | no       |
| Turborepo      | no           | yes      | no       |
| Lerna          | no           | yes      | yes      |



ä¾èµ–ç®¡ç†è¿‡äºåº•å±‚ï¼Œç‰ˆæœ¬æ§åˆ¶è¾ƒä¸ºç®€å•ä¸”å·²æˆç†Ÿï¼Œå°†è¿™ä¸¤é¡¹èƒ½åŠ›å†åšçªç ´æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®è·µä¸­åŸºæœ¬éƒ½æ˜¯ç»“åˆ Pnpm ä»¥åŠ  Changesets è¡¥å…¨æ•´ä½“èƒ½åŠ›ï¼Œç”šè‡³å°±å¹²è„†ä¸“ç²¾äºä¸€ç‚¹ï¼Œå³ä»»åŠ¡ç¼–æ’ï¼Œä¹Ÿå°±æ˜¯ Lage ä»¥åŠ Turborepo çš„å‘åŠ›ç‚¹ã€‚



#### å¦‚ä½•é€‰æ‹©åˆé€‚è‡ªå·±çš„ Monorepo å·¥å…·é“¾ï¼Ÿ

1. Pnpm Workspace + Changesetsï¼šæˆæœ¬ä½ï¼Œæ»¡è¶³å¤§å¤šæ•°åœºæ™¯
2. Pnpm Workspace + Changesets + Turborepo/Lageï¼šåœ¨ 1 çš„åŸºç¡€ä¸Šå¢å¼ºä»»åŠ¡ç¼–æ’èƒ½åŠ›
3. Rushï¼šè€ƒè™‘å…¨é¢ï¼Œæ‰©å±•æ€§å¼º

ä»»åŠ¡ç¼–æ’å¯ä»¥åˆ’åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œå„å·¥å…·æ”¯æŒå¦‚ä¸‹ï¼š


| <br/>          | èŒƒå›´ç•Œå®š | å¹¶è¡Œæ‰§è¡Œ | äº‘ç«¯ç¼“å­˜ |
| -------------- | -------- | -------- | -------- |
| Pnpm           | âœ…       | âœ…       | âŒ       |
| Rush           | âœ…       | âœ…       | âœ…       |
| Turborepo/Lage | âœ…       | âœ…       | âœ…       |


### TurboRepoçš„ä¼˜åŠ¿

#### å¤šä»»åŠ¡å¹¶è¡Œå¤„ç†

Turboæ”¯æŒå¤šä¸ªä»»åŠ¡çš„å¹¶è¡Œè¿è¡Œï¼Œæˆ‘ä»¬åœ¨å¯¹å¤šä¸ªå­åŒ…ç¼–è¯‘æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œturboä¼šåŒæ—¶è¿›è¡Œå¤šä¸ªä»»åŠ¡çš„å¤„ç†ã€‚åœ¨ä¼ ç»Ÿçš„ monorepo ä»»åŠ¡è¿è¡Œå™¨ä¸­ï¼Œå°±åƒ`lerna`æˆ–è€…`yarn`è‡ªå·±çš„å†…ç½®`workspaces run` å‘½ä»¤ä¸€æ ·ï¼Œæ¯ä¸ªé¡¹ç›®çš„scriptç”Ÿå‘½å‘¨æœŸè„šæœ¬éƒ½ä»¥æ‹“æ‰‘æ–¹å¼è¿è¡Œï¼ˆè¿™æ˜¯â€œä¾èµ–ä¼˜å…ˆâ€é¡ºåºçš„æ•°å­¦æœ¯è¯­ï¼‰æˆ–å•ç‹¬å¹¶è¡Œè¿è¡Œã€‚æ ¹æ® monorepo çš„ä¾èµ–å…³ç³»å›¾ï¼ŒCPU å†…æ ¸å¯èƒ½å¤„äºç©ºé—²çŠ¶æ€â€”â€”è¿™æ ·å°±ä¼šæµªè´¹å®è´µçš„æ—¶é—´å’Œèµ„æºã€‚

> ä»€ä¹ˆæ˜¯æ‹“æ‰‘ ï¼Ÿ
æ‹“æ‰‘ [Topological Order](https://turborepo.org/docs/glossary#topological-order) æ˜¯ä¸€ç§æ’åº æ‹“æ‰‘æ’åºæ˜¯ä¾èµ–ä¼˜å…ˆçš„æœ¯è¯­ï¼Œ å¦‚æœ A ä¾èµ–äº Bï¼ŒB ä¾èµ–äº Cï¼Œåˆ™æ‹“æ‰‘é¡ºåºä¸º Cã€Bã€Aã€‚
> 
> æ¯”å¦‚ä¸€ä¸ªè¾ƒå¤§çš„å·¥ç¨‹å¾€å¾€è¢«åˆ’åˆ†æˆè®¸å¤šå­å·¥ç¨‹ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å­å·¥ç¨‹ç§°ä½œæ´»åŠ¨(activity)ã€‚åœ¨æ•´ä¸ªå·¥ç¨‹ä¸­ï¼Œæœ‰äº›å­å·¥ç¨‹(æ´»åŠ¨)å¿…é¡»åœ¨å…¶å®ƒæœ‰å…³å­å·¥ç¨‹å®Œæˆä¹‹åæ‰èƒ½å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­å·¥ç¨‹çš„å¼€å§‹æ˜¯ä»¥å®ƒçš„æ‰€æœ‰å‰åºå­å·¥ç¨‹çš„ç»“æŸä¸ºå…ˆå†³æ¡ä»¶çš„

ä¸ºäº†å¯ä»¥äº†è§£turboå¤šä¹ˆå¼ºå¤§ï¼Œä¸‹å›¾æ¯”è¾ƒäº†turbo vs lernaä»»åŠ¡æ‰§è¡Œæ—¶é—´çº¿ï¼š

![](./images/turbo1.png)

Turboå®ƒèƒ½å¤Ÿæœ‰æ•ˆåœ°å®‰æ’ä»»åŠ¡ç±»ä¼¼äºç€‘å¸ƒå¯ä»¥åŒæ—¶å¼‚æ­¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè€Œlernaä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€é¡¹ä»»åŠ¡ æ‰€ä»¥Turboçš„ æ€§èƒ½ä¸è¨€è€Œå–»ã€‚


#### æ›´å¿«çš„å¢é‡æ„å»º

å¦‚æœæˆ‘ä»¬çš„é¡¹ç›®è¿‡å¤§ï¼Œæ„å»ºå¤šä¸ªå­åŒ…ä¼šé€ æˆæ—¶é—´å’Œæ€§èƒ½çš„æµªè´¹ï¼Œturborepoä¸­çš„ç¼“å­˜æœºåˆ¶ å¯ä»¥å¸®åŠ©æˆ‘ä»¬è®°ä½æ„å»ºå†…å®¹ å¹¶ä¸”è·³è¿‡å·²ç»è®¡ç®—è¿‡çš„å†…å®¹ï¼Œä¼˜åŒ–æ‰“åŒ…æ•ˆç‡ã€‚åº”è¯¥æ˜¯å€Ÿé‰´äº†nxã€‚

#### äº‘ç¼“å­˜

Turboé€šè¿‡å…¶è¿œç¨‹ç¼“å­˜åŠŸèƒ½å¯ä»¥å¸®åŠ©å¤šäººè¿œç¨‹æ„å»ºäº‘ç¼“å­˜å®ç°äº†æ›´å¿«çš„æ„å»ºã€‚

#### ä»»åŠ¡ç®¡é“

ç”¨é…ç½®æ–‡ä»¶å®šä¹‰ä»»åŠ¡ä¹‹é—´çš„å…³ç³»ï¼Œç„¶åè®©Turborepoä¼˜åŒ–æ„å»ºå†…å®¹å’Œæ—¶é—´ã€‚åœ¨ Turborepo ä¸­æœ‰ä¸ª Pipelines çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ç”± `turbo.json` æ–‡ä»¶ä¸­çš„ `pipeline` å­—æ®µçš„é…ç½®æè¿°ï¼Œå®ƒä¼šåœ¨æ‰§è¡Œ `turbo run` å‘½ä»¤çš„æ—¶å€™ï¼Œæ ¹æ®å¯¹åº”çš„é…ç½®è¿›è¡Œæœ‰åºçš„æ‰§è¡Œå’Œç¼“å­˜è¾“å‡ºçš„æ–‡ä»¶ã€‚

#### åŸºäºçº¦å®šçš„é…ç½®

é€šè¿‡çº¦å®šé™ä½å¤æ‚æ€§ï¼Œåªéœ€å‡ è¡ŒJSON å³å¯é…ç½®æ•´ä¸ªé¡¹ç›®ä¾èµ–ï¼Œæ‰§è¡Œè„šæœ¬çš„é¡ºåºç»“æ„ã€‚

#### æµè§ˆå™¨ä¸­çš„é…ç½®æ–‡ä»¶

ç”Ÿæˆæ„å»ºé…ç½®æ–‡ä»¶å¹¶å°†å…¶å¯¼å…¥Chromeæˆ–Edgeä»¥äº†è§£å“ªäº›ä»»åŠ¡èŠ±è´¹çš„æ—¶é—´æœ€é•¿ã€‚è¿™ç‚¹è¿˜æ¯”ä¸ä¸Šnxï¼Œnxå¯ä»¥ç›´æ¥ç”Ÿæˆæ‹“æ‰‘å›¾

### Turbo æ ¸å¿ƒæ¦‚å¿µ

åŒ…æ‹¬`pipeline`ï¼Œ`DependsOn`ï¼Œæ‹“æ‰‘ä¾èµ–ï¼Œ`Output`ï¼Œ`Caching`, `Remote Caching`ç­‰ï¼Œå¯ä»¥çœ‹å®˜ç½‘æœ‰è¯¦ç»†çš„æ–‡æ¡£æè¿°ã€‚


### Demoå®æˆ˜

æˆ‘ä»¬å¯ä»¥é€šè¿‡ç°æœ‰çš„monorepoæ”¹é€ ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºturboé¡¹ç›®ï¼Œç›´æ¥åˆ›å»ºå‚è€ƒå®˜ç½‘ï¼Œç›´æ¥é€‰æ‹©æ¨¡ç‰ˆä½“éªŒå°±è¡Œï¼Œè¿™é‡Œå°±ä¸å±•ç¤ºäº†ã€‚

turboçš„å¦ä¸€å¤§ç‰¹è‰²å°±æ˜¯æ”¹é€ ç°æœ‰çš„monorepoä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å®‰è£… turbo ä¾èµ–ï¼Œæ ¹ç›®å½•æ·»åŠ  `turbo.json` ä¸€åˆ‡å°±å°½åœ¨æŒæ¡äº†ã€‚

1. å®‰è£…
```shell
pnpm add turbo -Dw
```
2. åˆ›å»º`turbo.json`

trubo å¯ä»¥æ™ºèƒ½çš„å®‰æ’ä»»åŠ¡è°ƒåº¦ã€‚åœ¨æ ¹é¡¹ç›® `turbo.json` ä¸­å®šä¹‰ä»»åŠ¡çš„ä¾èµ–å…³ç³»ã€‚ä¾‹å¦‚ï¼š

```json
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"]
    },
    "test": {
      "dependsOn": ["build"]
    },
    "deploy": {
      "dependsOn": ["build", "test", "lint"]
    },
    "lint": {
      "outputs": []
    },
    "dev": {
      "dependsOn": ["build", "test", "lint"],
      "cache": false
    }
  }
}
```

ä¸Šé¢æè¿°çš„å¤§è‡´æ„æ€æ˜¯ï¼š

- `dependsOn` è¡¨ç¤ºå½“å‰å‘½ä»¤æ‰€ä¾èµ–çš„å‘½ä»¤ï¼Œ`^`è¡¨ç¤º `dependencies` å’Œ `devDependencies` çš„æ‰€æœ‰ä¾èµ–éƒ½æ‰§è¡Œå®Œ `build`ï¼Œæ‰æ‰§è¡Œ `build`
- `outputs `è¡¨ç¤ºå‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ–‡ä»¶ç¼“å­˜ç›®å½•ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸è§çš„ `dist`ã€`coverage` ç­‰
- `cache` è¡¨ç¤ºæ˜¯å¦ç¼“å­˜ï¼Œé€šå¸¸æˆ‘ä»¬æ‰§è¡Œ dev å‘½ä»¤çš„æ—¶å€™ä¼šç»“åˆ watch æ¨¡å¼ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹å…³é—­æ‰ç¼“å­˜æ¯”è¾ƒåˆ‡åˆå®é™…éœ€æ±‚
- `build` å‘½ä»¤æ‰§è¡Œä¾èµ–äºå…¶ä¾èµ–é¡¹çš„ `build` å‘½ä»¤æ‰§è¡Œå®Œæˆ
- `test` å‘½ä»¤æ‰§è¡Œä¾èµ–äºè‡ªèº«çš„ `build` å‘½ä»¤æ‰§è¡Œå®Œæˆ
- `lint` å‘½ä»¤å¯ä»¥ä»»ä½•æ—¶å€™æ‰§è¡Œ
- `deploy` å‘½ä»¤æ‰§è¡Œä¾èµ–äºè‡ªèº«çš„ `build test lint` å‘½ä»¤æ‰§è¡Œå®Œæˆ

ä½¿ç”¨ä¸€æ¡å‘½ä»¤æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡`turbo run lint build test deploy`

åœ¨`package.json`ä¸­é…ç½®`script`:

```json
{
  "scripts": {
    "build": "turbo run build",
    "dev": "turbo run dev --parallel",
    "lint": "turbo run lint"
  }
}
```
åªè¦ä½ çš„æ¯ä¸ªåŒ…æˆ–è€…appçš„`package.json`ä¸­é…ç½®çš„`script`éƒ½ç¬¦åˆé…ç½®ï¼Œé‚£ä¹ˆturboå°±ç®—åŸºæœ¬é…ç½®å®Œæˆäº†ï¼Œæ˜¯çœŸçš„ğŸ®ã€‚

maybe need to add more detail...

## Reference
- [Monorepos in JavaScript & TypeScript](https://www.robinwieruch.de/javascript-monorepos/)
- [monorepoå·¥ä½œæµåŸºç¡€ä¹‹changesetsæ‰“å¼€ä¸è¿›é˜¶](https://blog.csdn.net/qq_21567385/article/details/122361591)
- [Changesets: æµè¡Œçš„ Monorepo åœºæ™¯å‘åŒ…å·¥å…·](https://mp.weixin.qq.com/s/QKqaO3U1gzwWb2sDiF4cLQ)
- [Ditching manual releases with Changesets](https://dnlytras.com/blog/using-changesets/)
- [ä» Turborepo çœ‹ Monorepo å·¥å…·çš„ä»»åŠ¡ç¼–æ’èƒ½åŠ›](https://mp.weixin.qq.com/s/OrekHmMrn8UlisTrvt3MNA)
- [semantic-release](https://github.com/semantic-release/semantic-release)
- [monorepoå‚è€ƒä»“åº“](https://github.com/ycjcl868/monorepo/issues/9#issuecomment-1139647579)
- [Monorepo ä¸‹çš„æ¨¡å—åŒ…è®¾è®¡å®è·µ](https://juejin.cn/post/7052271542000074782)
---
